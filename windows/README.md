# Windows Environment Guide

このディレクトリには、Windows環境でVlog Auto Diaryを実行するためのスクリプトが含まれています。

## ファイル構成

- **`bootstrap.bat`**: 初回セットアップ用。
  - `.env`ファイルの作成（`.env.example`からコピー）
  - 必要なディレクトリ（`data`, `logs`など）の作成
  - タスクスケジューラへの登録（ログイン時に自動起動）
  - 初回起動
- **`run.bat`**: アプリケーション起動用。
  - 仮想環境（`.venv-win`）を使用してPythonアプリケーションを実行します。

## 使い方

### 初回セットアップ

管理者権限で `bootstrap.bat` を実行してください。
これにより、必要な環境設定が行われ、次回ログイン時から自動的にバックグラウンドで起動するようになります。

### 手動起動

`run.bat` をダブルクリックして実行してください。

## トラブルシューティング / 注意事項

### 1. ウィンドウがすぐに閉じてしまう場合

エラーが発生している可能性があります。`run.bat` や `bootstrap.bat` の末尾には `pause` コマンドが入っており、エラーメッセージを確認できるようになっています。
もしウィンドウが閉じてしまう場合は、コマンドプロンプトを開き、手動でバッチファイルを実行して出力を確認してください。

### 2. ネットワークドライブ（UNCパス）での実行

`\\server\share\path` のようなネットワークパス上で実行する場合、通常の `cd` コマンドではディレクトリ移動ができません。
そのため、スクリプト内では `pushd "%~dp0.."` を使用して、一時的にドライブ文字を割り当てて移動しています。
もしパス関連のエラーが出る場合は、ネットワークドライブを `Z:` などのドライブレターに割り当ててから実行することを推奨します。

### 3. Python環境

Windows用の仮想環境は `.venv-win` ディレクトリに作成されます。
WSL（Linux）側の `.venv` とは互換性がないため、混同しないように注意してください。

### 4. ログの確認

実行ログはプロジェクトルートの `logs/vlog.log` に出力されます。
動作がおかしい場合は、まずこのファイルを確認してください。
